{% extends "dashboard/base_dashboard.html" %}

{% block title %}Admin Analytics - WeBox Multi-IA{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/admin-analytics.css">
{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ğŸ” Admin Analytics</h1>
    <p>Tableau de bord administrateur - Statistiques et mÃ©triques avancÃ©es</p>
</div>

    <!-- Statistiques globales -->
    <section class="stats-overview">
        <div class="stat-card">
            <div class="stat-icon">ğŸ‘¥</div>
            <div class="stat-content">
                <div class="stat-value" id="totalUsers">0</div>
                <div class="stat-label">Utilisateurs totaux</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon">â­</div>
            <div class="stat-content">
                <div class="stat-value" id="premiumUsers">0</div>
                <div class="stat-label">Utilisateurs Premium</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon">ğŸŸ¢</div>
            <div class="stat-content">
                <div class="stat-value" id="activeUsers">0</div>
                <div class="stat-label">Utilisateurs actifs</div>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon">ğŸ’°</div>
            <div class="stat-content">
                <div class="stat-value" id="revenue">0â‚¬</div>
                <div class="stat-label">Revenus du mois</div>
            </div>
        </div>
    </section>

    <!-- Graphiques -->
    <section class="charts-section">
        <div class="chart-card">
            <h3>ğŸ“Š Croissance des utilisateurs</h3>
            <div class="chart-placeholder">
                <canvas id="usersChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <h3>ğŸ’µ Revenus mensuels</h3>
            <div class="chart-placeholder">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>
    </section>

    <!-- ActivitÃ© rÃ©cente -->
    <section class="activity-section">
        <h2>ğŸ”” ActivitÃ© rÃ©cente</h2>
        <div class="activity-list">
            <div class="activity-item">
                <div class="activity-icon">ğŸ‘¤</div>
                <div class="activity-content">
                    <div class="activity-title">Nouvel utilisateur inscrit</div>
                    <div class="activity-time">Il y a 5 minutes</div>
                </div>
            </div>

            <div class="activity-item">
                <div class="activity-icon">â­</div>
                <div class="activity-content">
                    <div class="activity-title">Upgrade vers Premium</div>
                    <div class="activity-time">Il y a 15 minutes</div>
                </div>
            </div>

            <div class="activity-item">
                <div class="activity-icon">ğŸ¤–</div>
                <div class="activity-content">
                    <div class="activity-title">1000 requÃªtes IA traitÃ©es</div>
                    <div class="activity-time">Il y a 1 heure</div>
                </div>
            </div>

            <div class="activity-item">
                <div class="activity-icon">ğŸš€</div>
                <div class="activity-content">
                    <div class="activity-title">Nouveau projet crÃ©Ã©</div>
                    <div class="activity-time">Il y a 2 heures</div>
                </div>
            </div>
        </div>
    </section>

    <!-- MÃ©triques systÃ¨me -->
    <section class="system-metrics">
        <h2>âš™ï¸ MÃ©triques systÃ¨me</h2>
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-label">Utilisation CPU</div>
                <div class="metric-value">45%</div>
                <div class="metric-bar">
                    <div class="metric-fill" style="width: 45%;"></div>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-label">Utilisation RAM</div>
                <div class="metric-value">62%</div>
                <div class="metric-bar">
                    <div class="metric-fill" style="width: 62%;"></div>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-label">Stockage</div>
                <div class="metric-value">38%</div>
                <div class="metric-bar">
                    <div class="metric-fill" style="width: 38%;"></div>
                </div>
            </div>

            <div class="metric-card">
                <div class="metric-label">Bande passante</div>
                <div class="metric-value">71%</div>
                <div class="metric-bar">
                    <div class="metric-fill" style="width: 71%;"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Actions rapides admin -->
    <section class="admin-actions">
        <h2>âš¡ Actions rapides</h2>
        <div class="actions-grid">
            <button class="action-btn">
                <span class="action-icon">ğŸ‘¥</span>
                <span>GÃ©rer utilisateurs</span>
            </button>
            <button class="action-btn">
                <span class="action-icon">ğŸ”‘</span>
                <span>ClÃ©s API</span>
            </button>
            <button class="action-btn">
                <span class="action-icon">âš™ï¸</span>
                <span>Configuration</span>
            </button>
            <button class="action-btn">
                <span class="action-icon">ğŸ“Š</span>
                <span>Rapports</span>
            </button>
            <button class="action-btn">
                <span class="action-icon">ğŸ”’</span>
                <span>SÃ©curitÃ©</span>
            </button>
            <button class="action-btn">
                <span class="action-icon">ğŸ“§</span>
                <span>Emails</span>
            </button>
        </div>
    </section>

<script>
document.addEventListener('DOMContentLoaded', async function() {
    // Charger les statistiques
    await loadAdminStats();
});

async function loadAdminStats() {
    try {
        const response = await fetch('/api/admin/stats');
        const data = await response.json();
        
        if (data.success) {
            document.getElementById('totalUsers').textContent = data.stats.total_users;
            document.getElementById('premiumUsers').textContent = data.stats.premium_users;
            document.getElementById('activeUsers').textContent = data.stats.active_users;
        }
    } catch (error) {
        console.error('Erreur lors du chargement des statistiques:', error);
    }
}
</script>
{% endblock %}
